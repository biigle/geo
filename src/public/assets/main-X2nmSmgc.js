import{_ as g,I as f}from"./imageMap-fHwHwLjf.js";import{resolveComponent as r,createBlock as m,openBlock as n,withCtx as v,createCommentVNode as b,createTextVNode as i,createElementVNode as s,createElementBlock as I}from"vue";let M=biigle.$require("volumes.components.filterListComponent"),_=biigle.$require("core.mixins.loader"),k=biigle.$require("resource"),p=biigle.$require("volumes.stores.filters"),w=biigle.$require("uiv.modal");const C=k("api/v1/volumes{/id}/coordinates",{}),x={mixins:[_],components:{modal:w,imageMap:f},props:{volumeId:{type:Number,required:!0}},data(){return{show:!1,images:[],disabled:!0,imageIds:[]}},methods:{callback(t){t==="ok"?this.$emit("on",this.imageIds):this.$emit("close-modal")},handleSelectedImages(t){t.length>0?(this.imageIds=[...t.sort()],this.disabled=!1):(this.imageIds=[],this.disabled=!0)}},created(){this.startLoading(),this.show=!0,C.get({id:this.volumeId}).then(t=>this.images=t.body,this.handleErrorResponse).finally(this.finishLoading)}},y={slot:"footer"},q=["disabled"];function V(t,e,u,h,o,l){const d=r("image-map"),c=r("modal");return n(),m(c,{modelValue:o.show,"onUpdate:modelValue":e[2]||(e[2]=a=>o.show=a),title:"Map Filter",size:"lg",backdrop:!1,onHide:l.callback},{default:v(()=>[o.images.length?(n(),m(d,{key:0,images:o.images,selectable:!0,onSelect:l.handleSelectedImages},null,8,["images","onSelect"])):b("",!0),e[4]||(e[4]=i()),e[5]||(e[5]=s("p",{class:"text-muted"},[s("em",null,"Hint:"),i(" Select image locations on the volume map by drawing an encompassing rectangle. To do this, press and hold "),s("kbd",null,"Ctrl"),i(` as well as the left mouse button and move the cursor on the map.
        `)],-1)),e[6]||(e[6]=i()),s("div",y,[s("button",{class:"btn btn-default",onClick:e[0]||(e[0]=a=>l.callback("dismiss"))},"Cancel"),e[3]||(e[3]=i()),s("button",{class:"btn btn-default",onClick:e[1]||(e[1]=a=>l.callback("ok")),disabled:o.disabled},"Add rule",8,q)])]),_:1},8,["modelValue","onHide"])}const $=g(x,[["render",V],["__scopeId","data-v-ad35f4cf"]]),S={components:{geoMapModal:$},props:{volumeId:{type:Number,required:!0}},data(){return{selectedItem:[],showModal:!1}},methods:{submit(t){this.hideModal(),this.selectedItem=t,this.$emit("select",this.selectedItem)},hideModal(){this.showModal=!1}}},A={class:"filter-select"};function L(t,e,u,h,o,l){const d=r("geo-map-modal");return n(),I("div",A,[o.showModal?(n(),m(d,{key:0,volumeId:u.volumeId,onOn:l.submit,onCloseModal:l.hideModal},null,8,["volumeId","onOn","onCloseModal"])):b("",!0),e[1]||(e[1]=i()),s("button",{type:"submit",class:"btn btn-default pull-right position",onClick:e[0]||(e[0]=c=>o.showModal=!0)},"Add rule")])}const N=g(S,[["render",L],["__scopeId","data-v-eb6b98d2"]]);Array.isArray(p)&&p.push({id:"location",types:["image"],label:"geo selection",help:"All images that were (not) selected on the world map.",listComponent:{mixins:[M],data(){return{name:"geo selection"}}},selectComponent:{mixins:[N],components:{},data(){return{}}},getSequence(t,e){return new Vue.Promise.resolve({data:e})}});
